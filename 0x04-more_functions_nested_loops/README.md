more c functions and nested loops
